<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SE - PHON 32 | Underwater Drone Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Space Grotesk', sans-serif;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(6, 182, 212, 0.3); }
            50% { box-shadow: 0 0 20px rgba(6, 182, 212, 0.6); }
        }
        
        @keyframes pulse-ring {
            0% { transform: scale(0.95); opacity: 0.7; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.7; }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        .glow-animation {
            animation: glow 2s ease-in-out infinite;
        }
        
        .pulse-ring {
            animation: pulse-ring 2s ease-in-out infinite;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass-morphism {
            background: rgba(10, 10, 15, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-3d {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .card-3d:hover {
            transform: rotateX(2deg) rotateY(2deg) scale(1.02);
        }
        
        .water-bg {
            background: linear-gradient(145deg, #0b1a2e 0%, #1a2f3f 100%);
        }
        
        .dark .water-bg {
            background: linear-gradient(145deg, #030712 0%, #111827 100%);
        }
        
        .grid-bg {
            background-image: 
                linear-gradient(rgba(6, 182, 212, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .neon-border {
            position: relative;
            border: 1px solid transparent;
        }
        
        .neon-border::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #06b6d4, #3b82f6, #a855f7);
            border-radius: inherit;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }
        
        .neon-border:hover::before {
            opacity: 0.5;
        }
        
        .terminal-text {
            font-family: 'Space Grotesk', monospace;
            letter-spacing: 0.5px;
        }
        
        .data-stream {
            background: linear-gradient(90deg, transparent, rgba(6, 182, 212, 0.2), transparent);
            background-size: 200% 100%;
            animation: stream 3s linear infinite;
        }
        
        @keyframes stream {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .cyber-line {
            height: 2px;
            background: linear-gradient(90deg, transparent, #06b6d4, #a855f7, #06b6d4, transparent);
            background-size: 200% 100%;
            animation: cyber 4s linear infinite;
        }
        
        @keyframes cyber {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .glitch {
            position: relative;
        }
        
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.8;
        }
        
        .glitch::before {
            color: #0ff;
            z-index: -1;
            animation: glitch-1 0.3s infinite linear alternate;
        }
        
        .glitch::after {
            color: #f0f;
            z-index: -2;
            animation: glitch-2 0.3s infinite linear alternate;
        }
        
        @keyframes glitch-1 {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        
        @keyframes glitch-2 {
            0% { transform: translate(0); }
            20% { transform: translate(2px, -2px); }
            40% { transform: translate(2px, 2px); }
            60% { transform: translate(-2px, -2px); }
            80% { transform: translate(-2px, 2px); }
            100% { transform: translate(0); }
        }
        
        .rotate-y {
            transition: transform 0.5s ease;
        }
        
        .rotate-y:hover {
            transform: rotateY(10deg);
        }
        
        .border-gradient {
            border: 2px solid transparent;
            border-image: linear-gradient(45deg, #06b6d4, #a855f7);
            border-image-slice: 1;
        }
    </style>
</head>

<body class="water-bg text-slate-100 min-h-screen overflow-x-hidden">

    <!-- Animated Background -->
    <div class="fixed inset-0 grid-bg opacity-30 pointer-events-none"></div>
    
    <!-- Floating Particles -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="absolute top-20 left-10 w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></div>
        <div class="absolute top-40 right-20 w-3 h-3 bg-blue-400 rounded-full animate-pulse delay-300"></div>
        <div class="absolute bottom-20 left-1/4 w-2 h-2 bg-purple-400 rounded-full animate-pulse delay-700"></div>
        <div class="absolute top-1/3 right-1/3 w-1 h-1 bg-cyan-300 rounded-full animate-pulse delay-500"></div>
        <div class="absolute bottom-1/4 right-1/4 w-3 h-3 bg-blue-300 rounded-full animate-pulse delay-1000"></div>
    </div>

    <!-- Header - Redesigned -->
    <header class="glass-morphism sticky top-0 z-50 border-b border-cyan-500/30">
        <div class="max-w-[1400px] mx-auto px-8 py-5">
            <div class="flex items-center justify-between">
                <!-- Logo Area -->
                <div class="flex items-center gap-3 group">
                    <div class="relative">
                        <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-purple-600 rounded-xl rotate-45 group-hover:rotate-90 transition-all duration-700"></div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-xl font-black text-white rotate-[-45deg] group-hover:rotate-[-90deg] transition-all duration-700">SE</span>
                        </div>
                    </div>
                    <div>
                        <h1 class="text-3xl font-black tracking-tight">
                            <span class="bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">PHON 32</span>
                        </h1>
                        <p class="text-[8px] text-cyan-300/70 tracking-[0.3em] uppercase">deep sea telemetry</p>
                    </div>
                </div>

                <!-- Status Bar -->
                <div class="flex items-center gap-10">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="relative group">
                        <div class="absolute inset-0 bg-cyan-500/20 rounded-full blur-xl group-hover:blur-2xl transition-all"></div>
                        <div class="relative w-12 h-12 rounded-full bg-slate-800/50 flex items-center justify-center border border-cyan-500/50">
                            <i data-lucide="moon" class="w-5 h-5 dark:hidden text-cyan-400"></i>
                            <i data-lucide="sun" class="w-5 h-5 hidden dark:block text-yellow-400"></i>
                        </div>
                    </button>

                    <!-- Clock -->
                    <div class="flex flex-col items-end">
                        <span class="text-[8px] font-mono text-cyan-400/60 tracking-widest">/// SYSTEM TIME</span>
                        <div class="flex items-center gap-1">
                            <span class="text-2xl font-mono font-bold text-cyan-300" id="clock">00:00:00</span>
                            <span class="text-xs text-cyan-500/50">UTC+7</span>
                        </div>
                    </div>

                    <!-- Sync Status -->
                    <div class="flex flex-col items-end pl-6 border-l border-cyan-500/30">
                        <span class="text-[8px] font-mono text-cyan-400/60 tracking-widest">/// SYNC</span>
                        <div class="flex items-center gap-2">
                            <div class="relative">
                                <div class="w-3 h-3 bg-emerald-500 rounded-full pulse-ring"></div>
                                <div class="absolute inset-0 bg-emerald-500 rounded-full animate-ping opacity-75"></div>
                            </div>
                            <span id="syncStatus" class="text-sm font-mono font-medium text-emerald-400 tracking-wider">00:00:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Animated Line -->
        <div class="cyber-line"></div>
    </header>

    <!-- Navigation Tabs - Redesigned -->
    <nav class="max-w-[1400px] mx-auto px-8 mt-8">
        <div class="flex gap-2 p-1.5 glass-morphism rounded-2xl w-fit">
            <button onclick="switchTab('monitoring')" id="tab-monitoring"
                class="relative px-8 py-4 text-sm font-bold tracking-widest uppercase transition-all rounded-xl group">
                <span class="relative z-10 text-slate-300 group-hover:text-white transition-colors">Monitoring</span>
                <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-cyan-500/0 to-purple-500/0 rounded-xl transition-all group-hover:from-cyan-500/20 group-hover:via-cyan-500/20 group-hover:to-purple-500/20"></div>
            </button>
            <button onclick="switchTab('reports')" id="tab-reports"
                class="relative px-8 py-4 text-sm font-bold tracking-widest uppercase transition-all rounded-xl group">
                <span class="relative z-10 text-slate-300 group-hover:text-white transition-colors">Reports</span>
                <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-cyan-500/0 to-purple-500/0 rounded-xl transition-all group-hover:from-cyan-500/20 group-hover:via-cyan-500/20 group-hover:to-purple-500/20"></div>
            </button>
        </div>
        <style>
            .tab-active-monitoring, .tab-active-reports {
                background: linear-gradient(145deg, rgba(6, 182, 212, 0.2), rgba(168, 85, 247, 0.2)) !important;
                border: 1px solid rgba(6, 182, 212, 0.3);
            }
        </style>
    </nav>

    <!-- Main Content -->
    <main class="max-w-[1400px] mx-auto px-8 py-10">

        <!-- Monitoring Section -->
        <section id="section-monitoring" class="space-y-10 block">
            <!-- Header with Refresh -->
            <div class="flex justify-between items-end">
                <div class="space-y-2">
                    <h2 class="text-5xl font-black tracking-tight">
                        <span class="bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent">REAL-TIME</span>
                        <span class="text-slate-500 ml-3 text-2xl">///</span>
                    </h2>
                    <p class="text-slate-500 font-mono text-sm tracking-wider flex items-center gap-2">
                        <span class="w-1 h-1 bg-cyan-500 rounded-full"></span>
                        LIVE DATA STREAM
                        <span class="w-1 h-1 bg-purple-500 rounded-full"></span>
                    </p>
                </div>
                <button onclick="refreshSystem()" id="refreshBtn"
                    class="group relative px-8 py-4 rounded-2xl overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-cyan-600 to-purple-600 opacity-80 group-hover:opacity-100 transition-opacity"></div>
                    <div class="absolute inset-0 bg-[url('data:image/svg+xml,...')] opacity-20"></div>
                    <div class="relative flex items-center gap-3 text-white font-bold tracking-widest text-sm">
                        <i data-lucide="refresh-cw" class="w-4 h-4 group-hover:rotate-180 transition-transform duration-1000" id="refreshIcon"></i>
                        <span>REFRESH SYSTEM</span>
                    </div>
                    <div class="absolute inset-0 -z-10 bg-gradient-to-r from-cyan-500 to-purple-500 blur-xl opacity-0 group-hover:opacity-50 transition-opacity"></div>
                </button>
            </div>

            <!-- Stats Grid - 3D Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- PH Card -->
                <div class="group card-3d">
                    <div class="relative p-8 rounded-3xl bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-cyan-500/30 backdrop-blur-xl overflow-hidden rotate-y">
                        <!-- Background Effects -->
                        <div class="absolute -top-20 -right-20 w-40 h-40 bg-cyan-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        <div class="absolute -bottom-20 -left-20 w-40 h-40 bg-purple-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        
                        <!-- Content -->
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl bg-cyan-500/20 flex items-center justify-center">
                                        <i data-lucide="flask-conical" class="w-5 h-5 text-cyan-400"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xs font-mono text-cyan-400/60 tracking-widest">/// SENSOR-01</h3>
                                        <span class="text-sm font-bold text-slate-400">PH LEVEL</span>
                                    </div>
                                </div>
                                <span class="px-4 py-2 bg-emerald-500/20 text-emerald-400 text-xs font-mono rounded-full border border-emerald-500/30">OPTIMAL</span>
                            </div>
                            
                            <div class="space-y-6">
                                <div class="flex items-baseline gap-2">
                                    <span class="text-7xl font-black bg-gradient-to-r from-cyan-400 to-cyan-300 bg-clip-text text-transparent" id="val-ph">0.0</span>
                                    <span class="text-slate-500 font-mono text-lg">pH</span>
                                </div>
                                
                                <!-- Animated Bar -->
                                <div class="relative h-2 bg-slate-700/50 rounded-full overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full" style="width: 0%;" id="ph-bar"></div>
                                    <div class="absolute inset-0 data-stream"></div>
                                </div>
                                
                                <div class="flex justify-between text-xs font-mono text-slate-500">
                                    <span>ACIDIC 0</span>
                                    <span class="text-cyan-400">NEUTRAL 7</span>
                                    <span>ALKALINE 14</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Corner Accents -->
                        <div class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-cyan-500/30 rounded-tl-3xl"></div>
                        <div class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-purple-500/30 rounded-br-3xl"></div>
                    </div>
                </div>

                <!-- Water Turbidity Card -->
                <div class="group card-3d">
                    <div class="relative p-8 rounded-3xl bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-blue-500/30 backdrop-blur-xl overflow-hidden rotate-y">
                        <div class="absolute -top-20 -right-20 w-40 h-40 bg-blue-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        <div class="absolute -bottom-20 -left-20 w-40 h-40 bg-cyan-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center">
                                        <i data-lucide="droplets" class="w-5 h-5 text-blue-400"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xs font-mono text-blue-400/60 tracking-widest">/// SENSOR-02</h3>
                                        <span class="text-sm font-bold text-slate-400">TURBIDITY</span>
                                    </div>
                                </div>
                                <span class="px-4 py-2 bg-blue-500/20 text-blue-400 text-xs font-mono rounded-full border border-blue-500/30">GOOD</span>
                            </div>
                            
                            <div class="space-y-6">
                                <div class="flex items-baseline gap-2">
                                    <span class="text-7xl font-black bg-gradient-to-r from-blue-400 to-blue-300 bg-clip-text text-transparent" id="val-water">0</span>
                                    <span class="text-slate-500 font-mono text-lg">NTU</span>
                                </div>
                                
                                <div class="relative h-2 bg-slate-700/50 rounded-full overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full" style="width: 0%;" id="turbidity-bar"></div>
                                    <div class="absolute inset-0 data-stream"></div>
                                </div>
                                
                                <div class="flex justify-between text-xs font-mono text-slate-500">
                                    <span>CLEAR 0</span>
                                    <span class="text-blue-400">MODERATE</span>
                                    <span>CLOUDY 100</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-blue-500/30 rounded-tl-3xl"></div>
                        <div class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-cyan-500/30 rounded-br-3xl"></div>
                    </div>
                </div>

                <!-- Battery Card -->
                <div class="group card-3d">
                    <div class="relative p-8 rounded-3xl bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-purple-500/30 backdrop-blur-xl overflow-hidden rotate-y">
                        <div class="absolute -top-20 -right-20 w-40 h-40 bg-purple-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        <div class="absolute -bottom-20 -left-20 w-40 h-40 bg-pink-500/20 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                        
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl bg-purple-500/20 flex items-center justify-center">
                                        <i data-lucide="battery-charging" class="w-5 h-5 text-purple-400"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xs font-mono text-purple-400/60 tracking-widest">/// SENSOR-03</h3>
                                        <span class="text-sm font-bold text-slate-400">BATTERY</span>
                                    </div>
                                </div>
                                <span class="px-4 py-2 bg-purple-500/20 text-purple-400 text-xs font-mono rounded-full border border-purple-500/30">CHARGING</span>
                            </div>
                            
                            <div class="space-y-6">
                                <div class="flex items-baseline gap-2">
                                    <span class="text-7xl font-black bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent" id="val-battery">0</span>
                                    <span class="text-slate-500 font-mono text-lg">%</span>
                                </div>
                                
                                <div class="relative h-2 bg-slate-700/50 rounded-full overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full" style="width: 0%;" id="battery-bar"></div>
                                    <div class="absolute inset-0 data-stream"></div>
                                </div>
                                
                                <div class="flex justify-between text-xs font-mono text-slate-500">
                                    <span>CRITICAL 0</span>
                                    <span class="text-purple-400">NORMAL</span>
                                    <span>FULL 100</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-purple-500/30 rounded-tl-3xl"></div>
                        <div class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-pink-500/30 rounded-br-3xl"></div>
                    </div>
                </div>
            </div>

            <!-- Chart Container - Redesigned -->
            <div class="relative p-8 rounded-3xl glass-morphism border border-cyan-500/30 neon-border">
                <!-- Header -->
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6 mb-8">
                    <div class="flex items-center gap-4">
                        <div class="w-2 h-12 bg-gradient-to-b from-cyan-500 to-purple-500 rounded-full"></div>
                        <div>
                            <h3 class="text-2xl font-black tracking-tight">
                                <span class="bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">HISTORICAL TREND</span>
                            </h3>
                            <p class="text-xs font-mono text-cyan-400/60 tracking-widest">/// LAST 20 SEQUENCES</p>
                        </div>
                    </div>
                    
                    <!-- Legend - Redesigned -->
                    <div class="flex gap-6 p-3 rounded-2xl bg-slate-800/30">
                        <div class="flex items-center gap-2 group/legend">
                            <div class="w-4 h-4 bg-cyan-500 rounded-full glow-animation"></div>
                            <span class="text-xs font-mono text-slate-400 group-hover/legend:text-cyan-400 transition-colors">pH</span>
                        </div>
                        <div class="flex items-center gap-2 group/legend">
                            <div class="w-4 h-4 bg-blue-500 rounded-full glow-animation"></div>
                            <span class="text-xs font-mono text-slate-400 group-hover/legend:text-blue-400 transition-colors">NTU</span>
                        </div>
                        <div class="flex items-center gap-2 group/legend">
                            <div class="w-4 h-4 bg-purple-500 rounded-full glow-animation"></div>
                            <span class="text-xs font-mono text-slate-400 group-hover/legend:text-purple-400 transition-colors">BAT</span>
                        </div>
                    </div>
                </div>
                
                <!-- Chart -->
                <div class="h-[400px] w-full p-4 rounded-2xl bg-slate-900/30">
                    <canvas id="trendChart"></canvas>
                </div>
                
                <!-- Decorative Elements -->
                <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-gradient-to-br from-cyan-500/20 to-purple-500/20 rounded-full blur-2xl"></div>
                <div class="absolute -top-2 -left-2 w-20 h-20 bg-gradient-to-br from-purple-500/20 to-cyan-500/20 rounded-full blur-2xl"></div>
            </div>
        </section>

        <!-- Reports Section - Redesigned -->
        <section id="section-reports" class="space-y-10 hidden">
            <div class="space-y-2">
                <h2 class="text-5xl font-black tracking-tight">
                    <span class="bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-transparent">DATA REPORTS</span>
                    <span class="text-slate-500 ml-3 text-2xl">///</span>
                </h2>
                <p class="text-slate-500 font-mono text-sm tracking-wider flex items-center gap-2">
                    <span class="w-1 h-1 bg-cyan-500 rounded-full"></span>
                    HISTORICAL ANALYSIS
                    <span class="w-1 h-1 bg-purple-500 rounded-full"></span>
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Summary Card -->
                <div class="lg:col-span-1 p-8 rounded-3xl glass-morphism border border-cyan-500/30">
                    <div class="flex justify-between items-center mb-8">
                        <h3 class="text-xl font-black tracking-tight">
                            <span class="bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">SUMMARY</span>
                        </h3>
                        <select onchange="fetchReports(this.value)"
                            class="bg-slate-800/50 border border-cyan-500/30 text-cyan-400 text-xs font-mono rounded-xl px-4 py-3 focus:ring-0 cursor-pointer outline-none">
                            <option value="daily" class="bg-slate-900">DAILY</option>
                            <option value="weekly" class="bg-slate-900">WEEKLY</option>
                            <option value="monthly" class="bg-slate-900">MONTHLY</option>
                        </select>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="p-5 rounded-xl bg-gradient-to-r from-slate-800/50 to-slate-900/50 border border-cyan-500/20">
                            <div class="flex justify-between items-center">
                                <span class="text-xs font-mono text-cyan-400/60">/// AVG PH</span>
                                <span id="rep-avg-ph" class="text-2xl font-black text-cyan-400">0.00</span>
                            </div>
                        </div>
                        
                        <div class="p-5 rounded-xl bg-gradient-to-r from-slate-800/50 to-slate-900/50 border border-blue-500/20">
                            <div class="flex justify-between items-center">
                                <span class="text-xs font-mono text-blue-400/60">/// MAX TURBIDITY</span>
                                <span id="rep-max-turb" class="text-2xl font-black text-blue-400">0 NTU</span>
                            </div>
                        </div>
                        
                        <div class="p-5 rounded-xl bg-gradient-to-r from-slate-800/50 to-slate-900/50 border border-purple-500/20">
                            <div class="flex justify-between items-center">
                                <span class="text-xs font-mono text-purple-400/60">/// LOG COUNT</span>
                                <span id="rep-total-logs" class="text-2xl font-black text-purple-400">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="exportToPDF()" id="pdfBtn"
                        class="group relative w-full mt-8 px-6 py-5 rounded-2xl overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-cyan-600 to-purple-600"></div>
                        <div class="relative flex items-center justify-center gap-3 text-white font-bold tracking-widest text-sm">
                            <i data-lucide="download" class="w-4 h-4 group-hover:translate-y-1 transition-transform"></i>
                            <span>EXPORT FULL REPORT</span>
                        </div>
                    </button>

                    <!-- Mini Chart -->
                    <div class="mt-8 pt-8 border-t border-cyan-500/30">
                        <h4 class="text-xs font-mono text-cyan-400/60 tracking-widest mb-6">/// PERIOD OVERVIEW</h4>
                        <div class="h-[200px]">
                            <canvas id="reportChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- History Table -->
                <div class="lg:col-span-2 rounded-3xl glass-morphism border border-cyan-500/30 overflow-hidden">
                    <div class="p-6 border-b border-cyan-500/30 bg-gradient-to-r from-cyan-500/10 to-purple-500/10">
                        <h3 class="text-sm font-mono text-cyan-400 tracking-widest">/// DATA LOGS</h3>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-800/50">
                                <tr>
                                    <th class="px-6 py-5 text-xs font-mono text-cyan-400/60 text-left">TIMESTAMP</th>
                                    <th class="px-6 py-5 text-xs font-mono text-cyan-400/60 text-left">PH</th>
                                    <th class="px-6 py-5 text-xs font-mono text-cyan-400/60 text-left">TURBIDITY</th>
                                    <th class="px-6 py-5 text-xs font-mono text-cyan-400/60 text-left">BATTERY</th>
                                </tr>
                            </thead>
                            <tbody id="report-table-body" class="divide-y divide-cyan-500/10">
                                <tr>
                                    <td colspan="4" class="px-6 py-16 text-center font-mono text-sm text-slate-500">LOADING DATA STREAM...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer - Redesigned -->
    <footer class="max-w-[1400px] mx-auto px-8 py-12">
        <div class="relative">
            <div class="cyber-line mb-8"></div>
            <div class="flex justify-between items-center">
                <p class="text-[10px] font-mono text-cyan-500/30 tracking-[0.3em] uppercase">
                    /// AUTOMATIC SYNCHRONIZATION ACTIVE
                </p>
                <p class="text-[10px] font-mono text-cyan-500/30 tracking-[0.3em] uppercase">
                    PHON 32 OS v1.0
                </p>
            </div>
        </div>
    </footer>

    <script>
        // [SAME JavaScript CODE - TIDAK DIUBAH]
        // Init Lucide Icons
        lucide.createIcons();

        // Theme Management
        const themeToggle = document.getElementById('themeToggle');
        const theme = localStorage.getItem('theme') || 'dark';
        if (theme === 'light') document.documentElement.classList.remove('dark');

        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateChartTheme();
        });

        // Clock Management
        let startTime = Date.now();
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('id-ID', { hour12: false });
            document.getElementById('clock').textContent = time;

            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const hrs = String(Math.floor(elapsed / 3600)).padStart(2, '0');
            const mins = String(Math.floor((elapsed % 3600) / 60)).padStart(2, '0');
            const secs = String(elapsed % 60).padStart(2, '0');
            document.getElementById('syncStatus').textContent = `${hrs}:${mins}:${secs}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Tab Management
        function switchTab(tab) {
            const monSection = document.getElementById('section-monitoring');
            const repSection = document.getElementById('section-reports');
            const monTab = document.getElementById('tab-monitoring');
            const repTab = document.getElementById('tab-reports');

            if (tab === 'monitoring') {
                monSection.classList.remove('hidden');
                repSection.classList.add('hidden');
                monTab.classList.add('tab-active-monitoring');
                monTab.classList.remove('tab-active-reports');
                repTab.classList.remove('tab-active-monitoring', 'tab-active-reports');
            } else {
                monSection.classList.add('hidden');
                repSection.classList.remove('hidden');
                repTab.classList.add('tab-active-reports');
                repTab.classList.remove('tab-active-monitoring');
                monTab.classList.remove('tab-active-monitoring', 'tab-active-reports');
            }
        }

        // Chart.js Implementation
        const ctx = document.getElementById('trendChart').getContext('2d');
        let trendChart;

        function initChart() {
            const isDark = document.documentElement.classList.contains('dark');
            const gridColor = isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(0, 0, 0, 0.05)';
            const textColor = isDark ? '#71717a' : '#71717a';

            const data = {
                labels: Array.from({ length: 20 }, (_, i) => ''),
                datasets: [
                    {
                        label: 'pH',
                        data: Array(20).fill(null),
                        borderColor: '#06b6d4',
                        backgroundColor: 'rgba(6,182,212,0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0,
                    },
                    {
                        label: 'Turbidity (NTU)',
                        data: Array(20).fill(null),
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59,130,246,0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0,
                        yAxisID: 'y1'
                    },
                    {
                        label: 'Battery (%)',
                        data: Array(20).fill(null),
                        borderColor: '#a855f7',
                        backgroundColor: 'rgba(168,85,247,0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 0,
                    }
                ]
            };

            trendChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index',
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { color: textColor, font: { size: 10 } }
                        },
                        y: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, font: { size: 10 } }
                        },
                        y1: {
                            position: 'right',
                            display: false
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: isDark ? '#18181b' : '#fff',
                            titleColor: isDark ? '#fff' : '#000',
                            bodyColor: isDark ? '#ccc' : '#444',
                            borderWidth: 1,
                            borderColor: 'rgba(255,255,255,0.1)',
                            padding: 12,
                            boxPadding: 6
                        }
                    }
                }
            });
        }

        function updateChartTheme() {
            if (trendChart) {
                trendChart.destroy();
                initChart();
            }
        }

        // Fetch Real Data from API
        let lastDataId = null;

        async function fetchData() {
            try {
                const response = await fetch('api.php?get_latest=true');
                const data = await response.json();

                if (data.status !== "empty" && data.id) {
                    if (data.id !== lastDataId) {
                        lastDataId = data.id;

                        document.getElementById('val-ph').textContent = parseFloat(data.kualitas_air).toFixed(1);
                        document.getElementById('val-water').textContent = Math.floor(data.tahan);
                        document.getElementById('val-battery').textContent = Math.floor(data.daya_listrik);

                        if (trendChart) {
                            trendChart.data.datasets[0].data.shift();
                            trendChart.data.datasets[0].data.push(parseFloat(data.kualitas_air));
                            trendChart.data.datasets[1].data.shift();
                            trendChart.data.datasets[1].data.push(parseFloat(data.tahan));
                            trendChart.data.datasets[2].data.shift();
                            trendChart.data.datasets[2].data.push(parseFloat(data.daya_listrik));
                            trendChart.update('none');
                        }

                        startTime = Date.now();
                        document.getElementById('syncStatus').className = "text-sm font-mono font-medium text-emerald-500 uppercase";
                    }
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('syncStatus').textContent = "OFFLINE";
                document.getElementById('syncStatus').className = "text-sm font-mono font-medium text-amber-500 uppercase";
            }
        }

        // Report Chart Management
        let reportChart;
        function initReportChart(avgPh = 0, maxTurb = 0) {
            const ctxReport = document.getElementById('reportChart').getContext('2d');
            if (reportChart) reportChart.destroy();

            const isDark = document.documentElement.classList.contains('dark');

            reportChart = new Chart(ctxReport, {
                type: 'bar',
                data: {
                    labels: ['Avg pH', 'Max NTU (Scaled)'],
                    datasets: [{
                        data: [avgPh, maxTurb / 10],
                        backgroundColor: ['#06b6d4', '#3b82f6'],
                        borderRadius: 8,
                        barThickness: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 14,
                            grid: { color: isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)' },
                            ticks: { display: false }
                        },
                        x: { grid: { display: false }, ticks: { font: { size: 9 }, color: '#71717a' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        async function fetchReports(period = 'daily') {
            try {
                const response = await fetch(`api.php?get_reports=true&period=${period}`);
                const result = await response.json();

                if (result.status === "success") {
                    const s = result.summary;
                    const ph = s.avg_kualitas_air ? parseFloat(s.avg_kualitas_air) : 0;
                    const turb = s.max_tahan ? parseFloat(s.max_tahan) : 0;

                    document.getElementById('rep-avg-ph').textContent = ph.toFixed(2);
                    document.getElementById('rep-max-turb').textContent = Math.floor(turb) + " NTU";
                    document.getElementById('rep-total-logs').textContent = s.total_logs || "0";

                    initReportChart(ph, turb);

                    const tbody = document.getElementById('report-table-body');
                    const history = result.history || [];

                    if (history.length === 0) {
                        tbody.innerHTML = `<tr><td colspan="4" class="px-6 py-10 text-center text-xs text-zinc-400">Tidak ada data untuk periode ini.</td></tr>`;
                    } else {
                        tbody.innerHTML = history.map(row => {
                            const ts = row.timestamp || '-';
                            const ph_val = parseFloat(row.kualitas_air).toFixed(1);
                            const ntu_val = Math.floor(row.tahan);
                            const bat_val = Math.floor(row.daya_listrik);

                            const batColor = bat_val >= 60 ? 'text-emerald-500' : bat_val >= 30 ? 'text-amber-500' : 'text-red-500';

                            return `
                                <tr class="hover:bg-zinc-50 dark:hover:bg-zinc-800/30 transition-colors">
                                    <td class="px-6 py-4 text-xs font-mono text-zinc-400">${ts}</td>
                                    <td class="px-6 py-4 text-xs font-bold">${ph_val}</td>
                                    <td class="px-6 py-4 text-xs font-bold">${ntu_val} NTU</td>
                                    <td class="px-6 py-4 text-xs font-bold ${batColor}">${bat_val}%</td>
                                </tr>
                            `;
                        }).join('');
                    }
                } else {
                    document.getElementById('report-table-body').innerHTML =
                        `<tr><td colspan="4" class="px-6 py-10 text-center text-xs text-red-400">Gagal memuat data: ${result.message || 'Unknown error'}</td></tr>`;
                }
            } catch (error) {
                console.error('Error fetching reports:', error);
                document.getElementById('report-table-body').innerHTML =
                    `<tr><td colspan="4" class="px-6 py-10 text-center text-xs text-red-400">Koneksi ke server gagal.</td></tr>`;
            }
        }

        async function refreshSystem() {
            const btn = document.getElementById('refreshBtn');
            const icon = document.getElementById('refreshIcon');
            btn.disabled = true;
            icon.setAttribute('data-lucide', 'loader-2');
            icon.classList.add('animate-spin');
            lucide.createIcons();

            await fetchData();
            await fetchReports(document.querySelector('select')?.value || 'daily');

            btn.disabled = false;
            icon.setAttribute('data-lucide', 'refresh-cw');
            icon.classList.remove('animate-spin');
            lucide.createIcons();
        }

        function exportToPDF() {
            const btn = document.getElementById('pdfBtn');
            const originalText = btn.innerHTML;

            btn.disabled = true;
            btn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> Generating...';
            lucide.createIcons();

            const element = document.getElementById('section-reports');
            const opt = {
                margin: 10,
                filename: 'SE-PHON32-Report.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, backgroundColor: document.documentElement.classList.contains('dark') ? '#09090b' : '#ffffff' },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                btn.disabled = false;
                btn.innerHTML = originalText;
                lucide.createIcons();
            }).catch(err => {
                console.error('PDF Error:', err);
                btn.disabled = false;
                btn.innerHTML = originalText;
                lucide.createIcons();
            });
        }

        // Initialize
        initChart();
        setInterval(fetchData, 3000);
        setInterval(() => fetchReports(document.querySelector('select')?.value || 'daily'), 30000);
        fetchData();
        fetchReports();

        // Tab initialization
        document.getElementById('tab-monitoring').classList.add('tab-active-monitoring');
    </script>
</body>

</html>